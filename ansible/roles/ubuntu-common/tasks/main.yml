#roles/ubuntu-common/tasks/main.yml
---
- name: Common - Adding PPA
  apt_repository: repo={{ item }}
  with_items: ubuntu_apt_repositories

- name: Common - Update apt
  apt: update_cache=yes

- name: Common - Install System Packages
  apt: name={{ item }} state=latest
  with_items: ubuntu_sys_packages

- name: Common - Setting es_ES locale
  shell: locale-gen es_ES.UTF-8

- name: Common - Configure the timezone
  template: src=timezone.tpl dest=/etc/timezone

- name: Common - More Configure the timezone
  sudo: yes
  file: src=/usr/share/zoneinfo/{{ ubuntu_timezone }} dest=/etc/localtime state=link force=yes backup=yes

- name: Common - Set the hostname in /etc/hostname
  shell: echo {{ vagrant_hostname }} > /etc/hostname
  when: hostname is defined

- name: Common - Set the hostname
  shell: hostname {{ vagrant_hostname }}
  when: hostname is defined

- name: Common - Update /etc/hosts
  lineinfile: dest=/etc/hosts regexp='^127\.0\.0\.1' line='127.0.0.1 localhost {{ vagrant_hostname }}' owner=root group=root mode=0644
